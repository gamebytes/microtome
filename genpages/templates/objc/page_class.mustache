{{header}}
{{#class_imports}}
#import "{{.}}.h"
{{/class_imports}}

{{#props}}
static MTPropSpec* _{{name}}Spec = nil;
{{/props}}

@implementation {{name}} {
@protected
{{#props}}
    {{typename}}* _{{name}};
{{/props}}
}

{{#props}}
- ({{value_type.name}}){{name}} { return _{{name}}.value; }
{{/props}}

- (NSArray*)props { return MT_PROPS({{#props}}_{{name}}, {{/props}}); }

- (id)init {
    if ((self = [super init])) {
    {{#props}}
        _{{name}} = [[{{typename}} alloc] initWithPropSpec:_{{name}}Spec];
    {{/props}}
    }
    return self;
}

+ (void)initialize {
    if (self == [{{name}} class]) {
    {{#props}}
        _{{name}}Spec = {{#value_type.is_primitive}}[[MTPropSpec alloc] initWithName:@"{{name}}"];{{/value_type.is_primitive}}{{^value_type.is_primitive}}[[MTObjectPropSpec alloc] initWithName:@"{{name}}" nullable:{{nullable}} valueType:MTBuildType(@[ {{#value_type.all_typenames}}[{{.}} class], {{/value_type.all_typenames}} ])];{{/value_type.is_primitive}}
    {{/props}}
    }
}

@end

